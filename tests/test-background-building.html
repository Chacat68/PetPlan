<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åå°å»ºé€ åŠŸèƒ½æµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .test-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .test-section p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .info-box p {
            color: #1976D2;
            margin: 5px 0;
        }

        .success-box {
            background: #e8f5e9;
            border-left: 4px solid #4CAF50;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .success-box p {
            color: #2E7D32;
            margin: 5px 0;
        }

        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #FF9800;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .warning-box p {
            color: #F57C00;
            margin: 5px 0;
        }

        .status {
            font-weight: bold;
        }

        .link-button {
            display: inline-block;
            padding: 12px 24px;
            background: #764ba2;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s;
            margin: 10px 5px;
        }

        .link-button:hover {
            background: #5a3779;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(118, 75, 162, 0.3);
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ï¸ é¢†åœ°ç³»ç»Ÿåå°å»ºé€ åŠŸèƒ½æµ‹è¯•</h1>

        <div class="test-section">
            <h2>ğŸ“‹ æµ‹è¯•è¯´æ˜</h2>
            <p>æœ¬é¡µé¢ç”¨äºæµ‹è¯•é¢†åœ°ç³»ç»Ÿçš„åå°å»ºé€ åŠŸèƒ½ã€‚å»ºé€ è¿‡ç¨‹åŸºäºçœŸå®æ—¶é—´æˆ³ï¼Œå³ä½¿åˆ‡æ¢é¡µé¢æˆ–å…³é—­æµè§ˆå™¨ï¼Œå»ºé€ ä¹Ÿä¼šåœ¨åå°ç»§ç»­ã€‚</p>
        </div>

        <div class="test-section">
            <h2>ğŸ¯ æµ‹è¯• 1ï¼šåŸºæœ¬å»ºé€ åŠŸèƒ½</h2>
            <p>1. ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è·³è½¬åˆ°é¢†åœ°é¡µé¢</p>
            <p>2. ç‚¹å‡»ä»»æ„ç©ºåœ°å—ï¼ˆå¸¦ + å·ï¼‰</p>
            <p>3. é€‰æ‹©ä¸€ä¸ªå»ºç­‘å¼€å§‹å»ºé€ </p>
            <p>4. è§‚å¯Ÿè¿›åº¦æ¡å¢é•¿ç›´åˆ°å®Œæˆ</p>
            <div class="button-group">
                <a href="territory.html" class="link-button">å‰å¾€é¢†åœ°é¡µé¢</a>
            </div>
            <div class="success-box" style="display:none;" id="test1-result">
                <p>âœ… å¦‚æœå»ºé€ è¿›åº¦æ­£å¸¸å¢é•¿å¹¶åœ¨5ç§’åå®Œæˆï¼Œè¯´æ˜åŸºæœ¬åŠŸèƒ½æ­£å¸¸ï¼</p>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ”„ æµ‹è¯• 2ï¼šé¡µé¢åˆ·æ–°æ¢å¤å»ºé€ </h2>
            <p>1. åœ¨é¢†åœ°é¡µé¢å¼€å§‹å»ºé€ </p>
            <p>2. ç­‰å¾…çº¦2-3ç§’ï¼ˆè¿›åº¦çº¦50%ï¼‰</p>
            <p>3. åˆ·æ–°é¡µé¢ï¼ˆF5 æˆ– Cmd+Rï¼‰</p>
            <p>4. è§‚å¯Ÿå»ºé€ æ˜¯å¦ä»æ­£ç¡®è¿›åº¦ç»§ç»­</p>
            <div class="info-box">
                <p><strong>é¢„æœŸç»“æœï¼š</strong></p>
                <p>â€¢ æœªå®Œæˆï¼šæ˜¾ç¤º"å»ºé€ ä¸­..."å’Œå½“å‰è¿›åº¦</p>
                <p>â€¢ å·²å®Œæˆï¼šç›´æ¥æ˜¾ç¤ºå®Œæˆçš„å»ºç­‘</p>
            </div>
        </div>

        <div class="test-section">
            <h2>â†”ï¸ æµ‹è¯• 3ï¼šåˆ‡æ¢é¡µé¢åå°å»ºé€ </h2>
            <p>1. åœ¨é¢†åœ°é¡µé¢å¼€å§‹å»ºé€ </p>
            <p>2. ç«‹å³ç‚¹å‡»åº•éƒ¨"è§’è‰²"æŒ‰é’®è¿”å›ä¸»é¡µ</p>
            <p>3. ç­‰å¾… 6 ç§’</p>
            <p>4. ç‚¹å‡»åº•éƒ¨"é¢†åœ°"æŒ‰é’®è¿”å›</p>
            <div class="button-group">
                <button onclick="testPageSwitch()">å¼€å§‹æµ‹è¯•ï¼ˆè‡ªåŠ¨è®¡æ—¶ï¼‰</button>
            </div>
            <div id="test3-timer" class="warning-box" style="display:none;">
                <p id="timer-text"></p>
            </div>
            <div class="success-box" style="display:none;" id="test3-result">
                <p>âœ… å¦‚æœè¿”å›æ—¶å»ºç­‘å·²å®Œæˆï¼Œè¯´æ˜åå°å»ºé€ åŠŸèƒ½æ­£å¸¸ï¼</p>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸŒ™ æµ‹è¯• 4ï¼šç¦»çº¿å»ºé€ </h2>
            <p>1. åœ¨é¢†åœ°é¡µé¢å¼€å§‹å»ºé€ </p>
            <p>2. ç«‹å³å…³é—­æµè§ˆå™¨æ ‡ç­¾é¡µ</p>
            <p>3. ç­‰å¾… 6 ç§’</p>
            <p>4. é‡æ–°æ‰“å¼€é¢†åœ°é¡µé¢</p>
            <div class="info-box">
                <p><strong>é¢„æœŸç»“æœï¼š</strong>å»ºç­‘æ˜¾ç¤ºä¸ºå·²å®ŒæˆçŠ¶æ€</p>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ“Š å½“å‰çŠ¶æ€æ£€æŸ¥</h2>
            <p>æŸ¥çœ‹å½“å‰å»ºé€ é˜Ÿåˆ—å’Œå·²å®Œæˆçš„å»ºç­‘</p>
            <div class="button-group">
                <button onclick="checkStatus()">æ£€æŸ¥çŠ¶æ€</button>
                <button onclick="clearData()">æ¸…é™¤æ‰€æœ‰æ•°æ®</button>
            </div>
            <div id="status-display" class="info-box" style="display:none;">
                <p id="status-text"></p>
            </div>
        </div>

        <div class="nav-buttons">
            <a href="territory.html" class="link-button">ğŸ° å‰å¾€é¢†åœ°é¡µé¢</a>
            <a href="index.html" class="link-button">ğŸ  è¿”å›ä¸»é¡µ</a>
        </div>
    </div>

    <script type="module">
        import { getTerritorySystemInstance } from './js/modules/territory-system.js?v=35';
        import ResourceSystem from './js/modules/resource-system.js?v=35';

        window.territorySystem = null;
        window.resourceSystem = null;

        function initSystems() {
            if (!window.resourceSystem) {
                window.resourceSystem = ResourceSystem.getInstance();
                window.resourceSystem.loadFromLocalStorage();
            }
            if (!window.territorySystem) {
                window.territorySystem = getTerritorySystemInstance(window.resourceSystem);
                window.territorySystem.loadFromLocalStorage();
            }
        }

        window.testPageSwitch = function() {
            const timerBox = document.getElementById('test3-timer');
            const timerText = document.getElementById('timer-text');
            timerBox.style.display = 'block';
            
            let seconds = 6;
            timerText.textContent = `â±ï¸ è¯·åœ¨é¢†åœ°é¡µé¢å¼€å§‹å»ºé€ ï¼Œç„¶åè¿”å›ä¸»é¡µã€‚${seconds} ç§’åå¯ä»¥è¿”å›æŸ¥çœ‹ç»“æœ...`;
            
            const countdown = setInterval(() => {
                seconds--;
                if (seconds > 0) {
                    timerText.textContent = `â±ï¸ è¯·åœ¨é¢†åœ°é¡µé¢å¼€å§‹å»ºé€ ï¼Œç„¶åè¿”å›ä¸»é¡µã€‚${seconds} ç§’åå¯ä»¥è¿”å›æŸ¥çœ‹ç»“æœ...`;
                } else {
                    timerText.textContent = 'âœ… æ—¶é—´åˆ°ï¼ç°åœ¨å¯ä»¥è¿”å›é¢†åœ°é¡µé¢æŸ¥çœ‹å»ºé€ æ˜¯å¦å®Œæˆã€‚';
                    clearInterval(countdown);
                    document.getElementById('test3-result').style.display = 'block';
                }
            }, 1000);
        };

        window.checkStatus = function() {
            initSystems();
            
            const buildQueue = window.territorySystem.territoryData.buildQueue || [];
            const buildings = window.territorySystem.territoryData.buildings || [];
            
            let statusHTML = '<p><strong>ğŸ“Š å½“å‰çŠ¶æ€ï¼š</strong></p>';
            statusHTML += `<p>â€¢ å·²å®Œæˆå»ºç­‘æ•°é‡: ${buildings.length}</p>`;
            statusHTML += `<p>â€¢ å»ºé€ é˜Ÿåˆ—æ•°é‡: ${buildQueue.length}</p>`;
            
            if (buildQueue.length > 0) {
                statusHTML += '<p><strong>æ­£åœ¨å»ºé€ ï¼š</strong></p>';
                buildQueue.forEach((task, index) => {
                    const buildingInfo = window.territorySystem.buildingData[task.type];
                    const progress = window.territorySystem.getBuildProgress(task);
                    const remaining = window.territorySystem.getBuildRemainingTime(task);
                    statusHTML += `<p>${index + 1}. ${buildingInfo.name} - è¿›åº¦ ${progress}% - å‰©ä½™ ${remaining}ç§’</p>`;
                });
            }
            
            if (buildings.length > 0) {
                statusHTML += `<p><strong>å·²å®Œæˆå»ºç­‘ï¼š</strong></p>`;
                const buildingCount = {};
                buildings.forEach(b => {
                    buildingCount[b.type] = (buildingCount[b.type] || 0) + 1;
                });
                Object.keys(buildingCount).forEach(type => {
                    const buildingInfo = window.territorySystem.buildingData[type];
                    statusHTML += `<p>â€¢ ${buildingInfo.name} x${buildingCount[type]}</p>`;
                });
            }
            
            const statusDisplay = document.getElementById('status-display');
            const statusText = document.getElementById('status-text');
            statusText.innerHTML = statusHTML;
            statusDisplay.style.display = 'block';
        };

        window.clearData = function() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰é¢†åœ°æ•°æ®å—ï¼Ÿè¿™å°†åˆ é™¤æ‰€æœ‰å»ºç­‘å’Œå»ºé€ ä»»åŠ¡ã€‚')) {
                localStorage.removeItem('pet-plan-territory');
                localStorage.removeItem('pet-plan-resources');
                alert('âœ… æ•°æ®å·²æ¸…é™¤ï¼è¯·åˆ·æ–°é¡µé¢ã€‚');
                location.reload();
            }
        };

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–ç³»ç»Ÿ
        initSystems();
    </script>
</body>
</html>
