# 成就系统文档

## 概述

成就系统为玩家提供了目标驱动的游戏体验，包括日常任务、长期成就和成就奖励机制。

## 功能概述

### 核心功能

1. **日常任务** - 每日重置的任务，提供经常性的目标
2. **成就系统** - 长期性的成就目标，记录玩家的游戏进度
3. **任务奖励** - 完成任务和成就后获得金币、红宝石等奖励
4. **进度追踪** - 实时显示任务进度和完成情况

## 任务类型

### 日常任务

日常任务在每天重置，为玩家提供日常目标：

| 任务类型 | 说明 | 奖励 |
|--------|------|------|
| 战斗任务 | 击败指定数量的怪物 | 金币 |
| 升级任务 | 升级玩家或宠物等级 | 红宝石 |
| 资源任务 | 获取指定数量的资源 | 经验 |
| 建筑任务 | 建造或升级建筑 | 金币 + 红宝石 |

### 长期成就

长期成就包括：

| 成就类型 | 说明 | 奖励 |
|--------|------|------|
| 探险家 | 达到特定等级 | 成就点数 |
| 收集家 | 解锁全部宠物 | 成就点数 + 特殊奖励 |
| 建造者 | 完成领地建设 | 成就点数 |
| 战士 | 击败大量怪物 | 成就点数 |

## 系统架构

### 核心模块

**AchievementSystem** (`achievement-system.js`)
- 管理任务和成就数据
- 跟踪玩家进度
- 处理任务完成和奖励发放

**AchievementUI** (`achievement-ui.js`)
- 显示任务界面
- 处理用户交互
- 展示成就信息

## 数据结构

### 任务对象

```javascript
{
    id: 'daily_battle_1',              // 任务唯一ID
    type: 'daily',                     // 任务类型：daily/achievement
    name: '战斗高手',                  // 任务名称
    description: '击败10个怪物',       // 任务描述
    target: 10,                        // 目标数值
    current: 5,                        // 当前进度
    reward: {                          // 奖励
        coins: 1000,
        rubies: 50
    },
    completed: false,                  // 是否完成
    claimedReward: false              // 是否领取奖励
}
```

## 使用方法

### 在游戏中集成

```javascript
import { getAchievementSystemInstance } from './modules/achievement-system.js';

// 获取成就系统实例
const achievementSystem = getAchievementSystemInstance();

// 初始化系统
achievementSystem.init();

// 更新任务进度
achievementSystem.updateProgress('daily_battle', 1);

// 领取奖励
achievementSystem.claimReward('daily_battle_1');
```

### 打开成就界面

玩家可以通过点击游戏界面的成就按钮打开成就管理界面，查看：
- 当前日常任务列表和进度
- 长期成就列表
- 可领取的奖励

## 任务进度更新

### 自动更新

系统会在以下情况自动更新相关任务进度：
- 怪物被击败
- 玩家升级
- 资源获取
- 建筑建造/升级

### 手动更新

开发者可以手动触发进度更新：

```javascript
achievementSystem.updateProgress(taskId, amount);
```

## 奖励系统

### 奖励类型

1. **金币奖励** - 增加玩家金币
2. **红宝石奖励** - 增加玩家红宝石
3. **经验奖励** - 增加玩家经验值
4. **特殊奖励** - 解锁特殊物品或称号

### 领取奖励

玩家需要手动领取奖励。系统会在任务完成后显示可领取的奖励通知。

## 性能优化

- 任务数据使用对象池管理
- 进度更新进行批量处理
- UI 仅在进度改变时更新

## 存档集成

成就系统数据完全集成到存档系统中：
- 所有任务进度自动保存
- 奖励领取状态也会保存
- 日常任务基于服务器时间重置（本地实现）

---

**版本**：v1.0.0  
**最后更新**：2025年12月14日
